@using System.IO
@model String

@{
    var views = new List<FileInfo>();
    if(!string.IsNullOrEmpty(Request["type"])){
        views = ApiHelper.AllowedViews(Request["type"],new string[] { "~/views/shared/", "~/views/_ViewStart.cshtml" });
        if(views.Count==0){
            views = ApiHelper.Views(new string[] { "~/views/shared/", "~/views/_ViewStart.cshtml" });
        }
    }else{
        views = ApiHelper.Views(new string[] { "~/views/shared/", "~/views/_ViewStart.cshtml" });
    }
    <select name="@ViewData.ModelMetadata.PropertyName">
        @foreach(var f in views.OrderBy(x=>x.Name).ToList()){
            var selected =string.IsNullOrEmpty(Model)?false: Model.ToLower().Equals(ApiHelper.ToVirtualPath(f.FullName).ToLower());
            <option @(selected?"selected":"") value="@ApiHelper.ToVirtualPath(f.FullName)">
                @f.Name
            </option>
        }
    </select>
}